---
import BaseLayout from '../layouts/BaseLayout.astro';
import CodeBlock from '../components/CodeBlock.astro';
---

<BaseLayout title="AI Agents" description="62-agent AI system for QEMU/KVM automation">
  <!-- Header -->
  <section class="fade-in">
    <h2 class="font-display text-xl font-semibold text-base-content">AI Agent System</h2>
    <p class="mt-2 text-sm/6 text-base-content/70">
      62-agent 4-tier hierarchical system for complete workflow automation
    </p>
  </section>

  <!-- Cost Optimization -->
  <section class="mt-8 fade-in">
    <div class="rounded-xl bg-info/10 p-4 ring-1 ring-info/20">
      <h3 class="font-semibold text-info">Cost Optimization: ~48% Token Reduction</h3>
      <p class="mt-1 text-sm text-base-content/70">Opus for planning &bull; Sonnet for coordination &bull; Haiku for execution (80%+ tasks)</p>
    </div>
  </section>

  <!-- 4-Tier Hierarchy -->
  <section class="mt-12 fade-in">
    <h3 class="font-display text-lg font-semibold text-base-content">4-Tier Hierarchy</h3>

    <!-- Tier 1 -->
    <div class="mt-6">
      <div class="flex items-center gap-2">
        <span class="badge badge-primary">Tier 1</span>
        <span class="font-semibold">Strategic (Opus) - 1 Agent</span>
      </div>
      <div class="mt-2 rounded-xl bg-base-200 p-4 ring-1 ring-base-content/5">
        <table class="w-full text-sm">
          <tr>
            <td class="w-16 font-mono text-xs">001</td>
            <td class="w-32">orchestrator</td>
            <td class="text-base-content/70">Strategic coordination, complex task decomposition</td>
          </tr>
        </table>
      </div>
    </div>

    <!-- Tier 2 -->
    <div class="mt-6">
      <div class="flex items-center gap-2">
        <span class="badge badge-secondary">Tier 2</span>
        <span class="font-semibold">Domain Experts (Sonnet) - 10 Agents</span>
      </div>
      <div class="mt-2 overflow-x-auto rounded-xl bg-base-200 p-4 ring-1 ring-base-content/5">
        <table class="w-full text-sm">
          <tbody>
            <tr class="border-b border-base-content/5">
              <td class="w-16 py-1 font-mono text-xs">002</td>
              <td class="w-32 py-1">vm-operations</td>
              <td class="py-1 text-base-content/70">VM lifecycle management</td>
            </tr>
            <tr class="border-b border-base-content/5">
              <td class="py-1 font-mono text-xs">003</td>
              <td class="py-1">performance</td>
              <td class="py-1 text-base-content/70">Hyper-V, VirtIO tuning</td>
            </tr>
            <tr class="border-b border-base-content/5">
              <td class="py-1 font-mono text-xs">004</td>
              <td class="py-1">security</td>
              <td class="py-1 text-base-content/70">60+ checklist enforcement</td>
            </tr>
            <tr class="border-b border-base-content/5">
              <td class="py-1 font-mono text-xs">005</td>
              <td class="py-1">virtiofs</td>
              <td class="py-1 text-base-content/70">Filesystem sharing</td>
            </tr>
            <tr class="border-b border-base-content/5">
              <td class="py-1 font-mono text-xs">006</td>
              <td class="py-1">automation</td>
              <td class="py-1 text-base-content/70">QEMU guest agent</td>
            </tr>
            <tr class="border-b border-base-content/5">
              <td class="py-1 font-mono text-xs">007</td>
              <td class="py-1">health</td>
              <td class="py-1 text-base-content/70">System readiness</td>
            </tr>
            <tr class="border-b border-base-content/5">
              <td class="py-1 font-mono text-xs">008</td>
              <td class="py-1">prerequisites</td>
              <td class="py-1 text-base-content/70">Package installation</td>
            </tr>
            <tr class="border-b border-base-content/5">
              <td class="py-1 font-mono text-xs">009</td>
              <td class="py-1">git</td>
              <td class="py-1 text-base-content/70">Constitutional commits</td>
            </tr>
            <tr class="border-b border-base-content/5">
              <td class="py-1 font-mono text-xs">010</td>
              <td class="py-1">docs</td>
              <td class="py-1 text-base-content/70">Documentation sync</td>
            </tr>
            <tr>
              <td class="py-1 font-mono text-xs">011</td>
              <td class="py-1">cleanup</td>
              <td class="py-1 text-base-content/70">Redundant file removal</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Tier 4 -->
    <div class="mt-6">
      <div class="flex items-center gap-2">
        <span class="badge badge-accent">Tier 4</span>
        <span class="font-semibold">Task Executors (Haiku) - 51 Agents</span>
      </div>
      <div class="mt-2 grid grid-cols-1 gap-3 md:grid-cols-2">
        <div class="rounded-xl bg-base-200 p-4 ring-1 ring-base-content/5">
          <h4 class="font-semibold">02X VM Operations</h4>
          <p class="mt-1 text-sm text-base-content/70">create, configure, lifecycle, validate, snapshot</p>
        </div>
        <div class="rounded-xl bg-base-200 p-4 ring-1 ring-base-content/5">
          <h4 class="font-semibold">03X Performance</h4>
          <p class="mt-1 text-sm text-base-content/70">Hyper-V, CPU pin, hugepages, I/O, benchmark</p>
        </div>
        <div class="rounded-xl bg-base-200 p-4 ring-1 ring-base-content/5">
          <h4 class="font-semibold">04X Security</h4>
          <p class="mt-1 text-sm text-base-content/70">LUKS, firewall, BitLocker, virtio-fs RO, audit</p>
        </div>
        <div class="rounded-xl bg-base-200 p-4 ring-1 ring-base-content/5">
          <h4 class="font-semibold">05X VirtIO-FS</h4>
          <p class="mt-1 text-sm text-base-content/70">setup, WinFsp, mount, PST test, troubleshoot</p>
        </div>
        <div class="rounded-xl bg-base-200 p-4 ring-1 ring-base-content/5">
          <h4 class="font-semibold">06X Automation</h4>
          <p class="mt-1 text-sm text-base-content/70">GA install, virsh, polling, host-guest, scripts</p>
        </div>
        <div class="rounded-xl bg-base-200 p-4 ring-1 ring-base-content/5">
          <h4 class="font-semibold">07X Health</h4>
          <p class="mt-1 text-sm text-base-content/70">hardware, QEMU stack, VirtIO, network, report</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Slash Commands -->
  <section class="mt-12 fade-in">
    <h3 class="font-display text-lg font-semibold text-base-content">9 Slash Commands</h3>
    <p class="mt-2 text-sm/6 text-base-content/70">One-command workflows that orchestrate multiple agents:</p>

    <div class="mt-4 overflow-x-auto">
      <table class="w-full text-left text-sm">
        <thead>
          <tr class="border-b border-base-content/10">
            <th class="py-2 pr-4 font-semibold">Command</th>
            <th class="py-2 pr-4 font-semibold">Description</th>
            <th class="py-2 font-semibold">Flow</th>
          </tr>
        </thead>
        <tbody class="text-base-content/80">
          <tr class="border-b border-base-content/5">
            <td class="py-2 pr-4 font-mono text-xs text-primary">/guardian-health</td>
            <td class="py-2 pr-4">System readiness (42 prerequisites)</td>
            <td class="py-2 font-mono text-xs">001&rarr;007&rarr;07X</td>
          </tr>
          <tr class="border-b border-base-content/5">
            <td class="py-2 pr-4 font-mono text-xs text-primary">/guardian-vm</td>
            <td class="py-2 pr-4">Complete VM creation</td>
            <td class="py-2 font-mono text-xs">001&rarr;002&rarr;02X</td>
          </tr>
          <tr class="border-b border-base-content/5">
            <td class="py-2 pr-4 font-mono text-xs text-primary">/guardian-optimize</td>
            <td class="py-2 pr-4">Performance (85-95% native)</td>
            <td class="py-2 font-mono text-xs">001&rarr;003&rarr;03X</td>
          </tr>
          <tr class="border-b border-base-content/5">
            <td class="py-2 pr-4 font-mono text-xs text-primary">/guardian-security</td>
            <td class="py-2 pr-4">60+ hardening checklist</td>
            <td class="py-2 font-mono text-xs">001&rarr;004&rarr;04X</td>
          </tr>
          <tr class="border-b border-base-content/5">
            <td class="py-2 pr-4 font-mono text-xs text-primary">/guardian-virtiofs</td>
            <td class="py-2 pr-4">Read-only protection</td>
            <td class="py-2 font-mono text-xs">001&rarr;005&rarr;05X</td>
          </tr>
          <tr class="border-b border-base-content/5">
            <td class="py-2 pr-4 font-mono text-xs text-primary">/guardian-commit</td>
            <td class="py-2 pr-4">Constitutional Git workflow</td>
            <td class="py-2 font-mono text-xs">001&rarr;009&rarr;09X</td>
          </tr>
          <tr class="border-b border-base-content/5">
            <td class="py-2 pr-4 font-mono text-xs text-primary">/guardian-backup</td>
            <td class="py-2 pr-4">Encrypted backup creation</td>
            <td class="py-2 font-mono text-xs">001&rarr;004&rarr;046</td>
          </tr>
          <tr class="border-b border-base-content/5">
            <td class="py-2 pr-4 font-mono text-xs text-primary">/guardian-cleanup</td>
            <td class="py-2 pr-4">Repository hygiene</td>
            <td class="py-2 font-mono text-xs">001&rarr;011&rarr;11X</td>
          </tr>
          <tr>
            <td class="py-2 pr-4 font-mono text-xs text-primary">/guardian-documentation</td>
            <td class="py-2 pr-4">Documentation sync</td>
            <td class="py-2 font-mono text-xs">001&rarr;010&rarr;10X</td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <!-- Delegation Flow -->
  <section class="mt-12 fade-in">
    <h3 class="font-display text-lg font-semibold text-base-content">Delegation Flow</h3>

    <div class="mt-4 overflow-x-auto rounded-xl bg-base-300 p-4">
      <pre class="text-sm"><code class="text-base-content/90">User Request
    <span class="text-base-content/50">&darr;</span>
<span class="text-primary">001-orchestrator (Opus)</span> - Strategic decomposition
    <span class="text-base-content/50">&darr;</span>
<span class="text-secondary">00X-domain-expert (Sonnet)</span> - Domain coordination
    <span class="text-base-content/50">&darr;</span>
<span class="text-accent">0XX-task-executor (Haiku)</span> - Single task execution
    <span class="text-base-content/50">&darr;</span>
<span class="text-success">Result aggregation &rarr; User</span></code></pre>
    </div>
  </section>

  <!-- Usage Example -->
  <section class="mt-12 fade-in">
    <h3 class="font-display text-lg font-semibold text-base-content">Usage Example</h3>

    <CodeBlock
      code={`# Check system health
/guardian-health

# Output:
# ✓ CPU: Intel i7-14700 (VT-x enabled)
# ✓ RAM: 64GB (58GB available)
# ✓ IOMMU: 16 groups detected
# ✓ libvirtd: active
# ✓ Network: default active
#
# Health Score: 42/42 prerequisites met`}
      lang="bash"
    />
  </section>

  <!-- Navigation -->
  <section class="mt-12 fade-in">
    <div class="flex flex-wrap gap-4">
      <a href={`${import.meta.env.BASE_URL}installation`} class="btn btn-primary">
        Start Installation
        <span aria-hidden="true">&rarr;</span>
      </a>
      <a href={`${import.meta.env.BASE_URL}overview`} class="btn btn-ghost">Project Overview</a>
    </div>
  </section>
</BaseLayout>
